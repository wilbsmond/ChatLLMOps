next up for the illustrious lightning talks we've got Stefan coming on what's up dude I did thank you for having me I copied your look you know I love to have a shirt so I figured I'll also go for the summer look today that's what I'm talking about man that is what I'm talking about I love it I am so glad that you're feeling the vibe if anybody else is feeling the vibe and wants to get Hawaiian honest or tropical send us a selfie or post it in slack or post it on Twitter and tag us and I will send you some swag I will promise that I will send some swag we might even send some uh genius Cloud slag swag you're with if I can talk if I can put words together that will be what we will do so Stefan man I have been wasting a ton of time right now and my only job is to make sure that we are on time therefore I'm gonna hand it over to you I'm gonna let you get cracking with your 10 minute lightning talk and then uh I'll be I'll see you in 10 minutes dude all right thank you so much pen first of all thank you for joining uh my name is I'm here representing Genesis Cloud we have a fun fun project to showcase as soon as I get my slides changing so topic of the talk today is uh AI meets memes so how do we tag image flips this meme does not exist at the next level using a large language model all right selecting talk so let's go um first of all what does it mean I think everyone is familiar with the memes but yeah it's usually about mimicking something right so it's taking something that exists and making small variations of it and over the years you know you get layers and layers of meta why memes it's kind of interesting topic for large language models because in general humor is something that's not very well understood uh by or or explained by Humanity yet but um so first the previous brief history of meme generators using AI um back in 2018 there was a paper from Stanford research called Bank learning so they used a long short-term memory model then to generate means but um while it works somewhat it didn't really work for the structure of of the memes and this is something that the authors acknowledge then 2019 so dial and the founder of image flip did this himself using a deep convolutional neural network and this is the basis for the AI meme or this this meme does not exist service that's available on image flip and then going forward from 2020 and with the Advent of gbt a series of models yeah I've seen various hobby projects and even some Commercial Services uh generating memes but you can also do it yourself and we're gonna show you how so how did we end up here first of all let's just be honest I really like memes so it's a fun fun project for me um then we we at Chinese Cloud we are a provider for AI infrastructure so it's really important for us to understand from users perspective how does our infrastructure used to use for them right and and given the you know with the adventure GPT and the great public interest therefore on the large language models it really just seems like a fun project for us to learn from and I believe that the technology exists for generating memes so why not so here we are um so how I got started I wanted to do a quick reality check so back then uh when we got started with this the GPT was still based on the GPD 3.5 model um but for me it was the most advanced model at the time so I just wanted to check who the model like this understand the meme context so um because started so what we already in the first response we saw some hallucination it did not really understand how the meme template is for a Philosoraptor meme as for a caption first one not not really great but the second one yeah that's actually pretty good so yeah I put it in a template then yeah it's the meaning of life 42 because that's the only answer I'm getting no matter what I'm ask Google yeah I think that's somewhat funny and as comparison and actual human generated popular version of the meme if if the opposite of pro is gone is the opposite of progress Congress right so this silly but smart questions that's the idea of the name so I believe that there is really something there so we went ahead with the project then um so attention no no no data is all you need right so we figured okay to make this happen we need a meme data set who has the biggest uh meme data set it's image flip so they can't be provided with a huge uh data set so 60 650 000 mint templates most of them are like same same but different uh so the number of unique templates is actually unique templates is a lot smaller and there are like 40 million individually uh created memes by the users of the service that's what we are working with so the goal was to Showcase how a contemporary llm can create quality memes and we want and we wanted to expand the the existing service to cover more templates than it does currently and 255 would cover like six percent of all memes created so that's the number we settled on and we wanted to demonstrate how Genesis Cloud uh can serve such an l11 for millions millions of monthly users uh first we tried the you know what what we usually do is try the bird uh it's kind of well understood model uh they didn't get good results so we moved on from that pretty quickly and uh yeah we definitely get a little bit better results but this is the time when the Llama series model came out and these are like instruct models and uh and this is where I turned we turned our attention to so but the problem with this llama version is that the license the Forbes commercial use uh to note open Llama has been made available since but there's another set of thumbs so you have the red pajama and pitia um yeah we tried it but it really even though it was sometimes funny it just wasn't good enough it really struggled with the format a lot of the responses were just nonsense but stable LM this is very stressful so we found that this work easily the best it's not as good as gpt4 admittedly yet but close and I think we can make it make it equally good so now we have insert models right so we tried all kind of approach and approaches and this is what we found to work the best right so first you have this instruction for the model this is the overall context you know you need to uh tell the structures the two parties in three part name so forth uh then you have the input so the specific context of the name this is the prompt engineering part so you actually that it worked the best when you do this for each template we found out and then you have like the actual data so this is not the generated meme this is kind of the training that I use for fine fine tuning um then so um they basically use the lead parrot project with Elora and adapter and we only needed three epochs just make note that we this is a pre pro for concept data set so but we only still need a three three epochs for the model to convert and we expect not to need more than 10 10 Xbox two with the full full data set and the training time is really fast so using a four four times four gpus it was only 21 minutes to find units and yeah it's pretty easy also from the Ops perspective so we basically were able to max out the gpus and not waste any resources then the result so uh we basically use all of the three three um models mentioned earlier to create seven um seven iterations of the of the three templates so it's not like a big big data set to cherry pick from and I kind of graded them myself and 76 percent were actually funny to me so it's just my subjective uh judgment so have a have a look at yourself and these are now by the model that we built so where's I'm eating food make usable multivitamins of course you take that truth of true love oh that's a tough one but I guess that's a compromise you sometimes have to make uh then uh yeah this membrane below character sending text and text messages okay that's a pretty Grim choice I have to say but uh sometimes life is like that work harder drink okay yeah that's that's good then living with parents or to eat dinner yeah tough economy can be like that for sure and then lastly so only out of seven examples this came out and and I I swear that this is not this is not Cherry Cherry Picked or anything right right I mean talk or laugh laugh meme okay that that's funny then um how do we serve this means so um first we're gonna fine-tune the whole lot model for the 256 templates um so we did based on the the initial work we made some assumptions you you know um we measured that we get six tokens the second from the 3090 um the rough roughly expect like 10 tokens per request and based on their side Behavior so roughly for five million monthly requests so we calculated that without seasonality a unit roughly 4 gpus to serve this um we still haven't properly calculated this but we expect that the P close to be around 10 so we need like a scaling setup up to four uh for the gpus and the setup yeah it's pretty standard stuff you know it's very very similar to to nvidia's reference architecture so just use kubernetes for scaling put some monitoring in there and use Triton then to serve serve the model itself we provided them like an API that that image flip can can consume for their website yeah why not use just gpd4 yeah it's a black box uh open open AI API it becomes a single point of failure for your application that can be a real problem you don't control the you don't control your data a bit less important for memes but that can be important for some um you have also limited control over the model right and it's expensive at scale like really expensive you know the fine toning tuning disc cost costs roughly one dollar using genetic level only one dollar right then uh over a month generate 50 million tokens yeah it will depending on if you if you go on demand or long term you know it's 300 to 500 uh US Dollars over a month so not too bad right and if you would use the open air tape API it's 10 times it would be four and a half thousand US dollars so I'm I don't wanna trash open AI it's great for they do absolutely amazing work but sometimes when you do it yourself you you can get something similar with much less money right okay what's the problems except the two phase to keep it lean right so what will be the menu introduction needed uh while meeting an SLA meet again in latency there's some live approaches like looking at GP utilization but I didn't give you a queue time it's a better leading integration this is this is something that we will really investigate and yeah just just how to deal with a ton of concurrent requests yeah okay so that's that's the proof of concept so it's working uh we will continue so there will be another another talk with another time uh how we handle the trade training for the complete data set um we will then by then we will showcase the actual live production setup when when it's up and running and the the actual challenges we face not just the ones that we anticipated and then of course show some more memes model is also a little bit further developed yeah so thank you very much for listening for this quick lightning talk you for any questions and feedback you will find us in Genesis Cloud's virtual booth and a special thank you to to dial and from the founder of image flip for providing us with this amazing data set and tomorrow Marwan for doing the the model actual modeling board I'm here just good shout out to you for being the first and maybe the only person that I know that is using staple LM that is pretty impressive every time that I talk to it it hallucinates more than my college roommate uh try them all it's really amazing what they've done with lit hair with the lid parrot you know it makes easy to find using these models so they're all all of the three models are part of that so you I'd say like just just you know try it out and depending on the use case you know your mileage may vary you know and um yeah and I think it's like maybe it's very contextual humor is difficult right so if I'd say with relatively little effort and with simple setup we were able to to fine-tune a model I think um you will be also able to do the same for your for your business use case that might be um less less metal yeah awesome dude well thank you so much for coming on here and anybody that is interested in everything that you all are doing like we said before you can click on that little left sidebar that says Solutions and you can I think they can get some swag directly from you but I'm also going to be able to give out all kinds of Swag to them too so what I'm pretty sure you guys are giving out some socks or maybe some uh mugs I can't remember exactly and sucks there we go get over to that booth and claim your free swag so dude thanks so much Stefan I am going to keep it cruising [Music]